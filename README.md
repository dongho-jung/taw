# PAW (Parallel AI Workers)

[![CI](https://github.com/dongho-jung/paw/actions/workflows/ci.yml/badge.svg)](https://github.com/dongho-jung/paw/actions/workflows/ci.yml)
[![Release](https://github.com/dongho-jung/paw/actions/workflows/release.yml/badge.svg)](https://github.com/dongho-jung/paw/actions/workflows/release.yml)

A project management system built on Claude Code.

## Installation

```bash
brew install dongho-jung/tap/paw
```

## Overview

- Start a tmux-based workspace from any directory with the `paw` command.
- Creating a task automatically launches the Claude Code agent.
- **Git mode**: Each task gets its own worktree when running in a git repo.
- **Non-Git mode**: Shared by default; optionally use per-task workspace copies (`non_git_workspace: copy`).

## Usage

### Start paw in a project

```bash
cd /path/to/your/project  # git repo or regular directory
paw  # Creates .paw, starts tmux session, and automatically runs new-task
```

- In a git repo: Git mode (worktree created per task)
- In a regular directory: Non-Git mode (shared workspace by default; optional copy mode for isolation)

The first launch automatically opens the task editor.

### Create a task

To add another task inside the tmux session, press `‚åÉN`:
- The inline task input UI opens in the `‚≠êÔ∏èmain` window.
- Submit with `Alt+Enter` (or `F5`) to launch the agent; `Esc` cancels.
- Use `‚å•Tab` to edit per-task options (model, ultrathink, dependencies, worktree hook) before submitting.

**Task completion**:
- Press `‚åÉF` twice to finish; PAW commits changes and cleans up, pushes in `auto-pr`/`auto-merge`, and auto-merges in `auto-merge`.
- In `auto-pr`, the agent creates the PR before you finish.
- Optional verification and hooks can run before finish/merge (see config).

<details>
<summary>Automatically reopen incomplete tasks with session resume</summary>

If a task is left unfinished and the window or tmux session closes, the next `paw` run automatically reopens those task windows.

**Session Resume**: When reopening, Claude automatically continues the previous conversation session (using `claude --continue`), preserving the full conversation history and context. The agent continues exactly where it left off without restarting from scratch.
</details>

<details>
<summary>Automatically clean up merged tasks</summary>

Tasks merged externally (PR merge, direct branch merge, etc.) are cleaned up automatically when `paw` runs.
</details>

### Window states

- ‚≠êÔ∏è New task input window
- ü§ñ Working
- üí¨ Waiting (user input required)
- ‚úÖ Done
- ‚ö†Ô∏è Warning (merge failed, needs manual resolution)
- Status updates are automatic (wait watcher + Claude Code stop hook classification on exit).

## Configuration

### Initial setup

When you first run `paw`, the setup wizard appears:

```
üöÄ PAW Setup Wizard
Work Mode:
  1. worktree (Recommended) - Each task gets its own git worktree
  2. main - All tasks work on current branch

Select [1-2, default: 1]:

On Complete Action:
  1. confirm (Recommended) - Commit only (no push/PR/merge)
  2. auto-pr - Auto commit + push + create pull request     (worktree mode only)
  3. auto-merge - Auto commit + push + merge + cleanup      (worktree mode only)

Select [1-3, default: 1]:

‚úÖ Configuration saved!
   Work mode: worktree
   On complete: confirm
```

Settings are saved to `.paw/config`.

### Rerun setup

```bash
paw setup  # Rerun the setup wizard
```

<details>
<summary>Example config (.paw/config)</summary>

```
# PAW Configuration
# Generated by paw setup

# Work mode: worktree or main
# - worktree: Each task gets its own git worktree (recommended)
# - main: All tasks work on the current branch
work_mode: worktree

# On complete action: confirm, auto-merge, or auto-pr
# - confirm: Commit only (no push/PR/merge)
# - auto-merge: Auto commit + push + merge + cleanup + close window
# - auto-pr: Auto commit + push + create pull request
on_complete: confirm

# Non-git workspace: shared or copy
non_git_workspace: shared

# Hook to run after worktree/workspace creation (optional)
# Single line example: worktree_hook: npm install
# Multi-line example:
#   worktree_hook: |
#     npm install
#     npm run build

# Verification (optional)
# verify_command: npm test
verify_timeout_sec: 600
verify_required: false

# Hooks (optional)
# pre_task_hook: echo "pre task"
# post_task_hook: echo "post task"
# pre_merge_hook: echo "pre merge"
# post_merge_hook: echo "post merge"

# Log format: text or jsonl
log_format: text

# Log rotation (size in MB, backups)
log_max_size_mb: 10
log_max_backups: 3

```
</details>

### Configuration options

| Setting | Option | Description |
|---------|--------|-------------|
| `work_mode` | `worktree` | Create a git worktree per task (isolated, recommended) |
|             | `main` | Work directly on the current branch (simple) |
| `on_complete` | `confirm` | Commit only (no push/PR/merge) |
|               | `auto-merge` | **Auto** commit + push + merge + clean up + close window (worktree mode only) |
|               | `auto-pr` | Auto commit + push + create PR (worktree mode only) |
| `non_git_workspace` | `shared` | Use the project directory directly (default) |
|                   | `copy` | Create a per-task workspace copy (isolation) |
| `worktree_hook` | (command) | Shell command(s) to run after worktree/workspace creation (e.g., `npm install`) |
| `verify_command` | (command) | Shell command(s) to verify before finish/merge (e.g., `npm test`) |
| `verify_timeout_sec` | (seconds) | Verification timeout (default: 600) |
| `verify_required` | `true/false` | Block auto-merge if verification fails |
| `pre_task_hook` | (command) | Runs before starting the agent |
| `post_task_hook` | (command) | Runs after finishing a task |
| `pre_merge_hook` | (command) | Runs before auto-merge/merge-task |
| `post_merge_hook` | (command) | Runs after auto-merge/merge-task |
| `log_format` | `text/jsonl` | Log output format |
| `log_max_size_mb` | (MB) | Log rotation size (default: 10) |
| `log_max_backups` | (count) | Log rotation backups (default: 3) |
| `notifications` | `slack.webhook`, `ntfy.topic`, `ntfy.server` | Optional external alerts via Slack webhook or ntfy.sh |

When `non_git_workspace` is set to `copy`, PAW creates an isolated workspace under `.paw/agents/<task>/worktree`. Changes are not automatically merged back into the project; use hooks or manual copy when needed.

<details>
<summary>Other configuration</summary>

- System prompt: Embedded in binary (copied to `.paw/.claude/` on setup)
- `.paw/PROMPT.md`: Project-specific prompt (per project)
- `.paw/memory`: Project memory (YAML, update in place for reusable info)
- Notifications: Configure optional Slack/ntfy settings in `.paw/config`
</details>

## Dependencies

Use `paw check` to verify prerequisites.

| Dependency | Required | Purpose |
|------------|----------|---------|
| tmux | Yes | Terminal multiplexer for managing task windows |
| claude | Yes | Claude Code CLI for running agents |
| git | Optional | Needed for worktree mode in git repositories |
| gh | Optional | PR creation for `auto-pr` mode |
| paw-notify.app (macOS) | Optional | Desktop notifications and action buttons |

Install tmux/gh via Homebrew: `brew install tmux gh`. Install the Claude Code CLI from https://claude.ai/claude-code.

## tmux shortcuts

### Navigation
| Action | Shortcut |
|--------|----------|
| Cycle panes / task options (new task) | `‚å•Tab` |
| Move window | `‚å•‚Üê/‚Üí` |

### Task Commands
| Action | Shortcut |
|--------|----------|
| New task | `‚åÉN` |
| Cancel task (double-press) | `‚åÉK` |
| Finish task (double-press) | `‚åÉF` |
| Toggle branch (task ‚Üî main) | `‚åÉ‚Üë` |
| Sync from main (rebase) | `‚åÉ‚Üì` |
| Command palette | `‚åÉP` |
| Quit paw | `‚åÉQ` |

### Toggle Panels
| Action | Shortcut |
|--------|----------|
| Toggle tasks | `‚åÉT` |
| Toggle logs | `‚åÉO` |
| Toggle git status | `‚åÉG` |
| Toggle bottom (shell) | `‚åÉB` |
| Toggle help | `‚åÉ/` |

## Log viewer

Press `‚åÉO` to open the live log viewer.

Logs are written to `.paw/log` with optional JSONL formatting and rotation.
Use `paw logs --since 2h --task my-task` for CLI filtering.

<details>
<summary>Controls</summary>

| Key | Description |
|----|-------------|
| `‚Üë` / `‚Üì` | Scroll vertically |
| `‚Üê` / `‚Üí` | Scroll horizontally (when word wrap is off) |
| `g` | Jump to top |
| `G` | Jump to bottom |
| `PgUp` / `PgDn` | Page scroll |
| `s` | Toggle tail mode (follow new logs) |
| `w` | Toggle word wrap |
| `l` | Cycle log level filter (L0+ ‚Üí L1+ ‚Üí ... ‚Üí L5 only) |
| `q` / `Esc` | Close the log viewer |
</details>

## Task history

When a task ends, the full content of the agent pane is automatically captured and saved.

### Storage location

```
.paw/history/
‚îî‚îÄ‚îÄ YYMMDD_HHMMSS_task-name  # e.g., 241228_134501_my-feature
```

### Usage examples

- Review what the agent did in a past task.
- Trace how a problem was solved.
- Use as reference material for learning and improvement.

Use `paw history` to list entries and `paw history show <index|task|file>` to view one.

## CLI utilities

- `paw check --fix` attempts Homebrew installs for missing dependencies and repairs missing PAW files/folders.
