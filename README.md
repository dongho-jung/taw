# PAW (Parallel AI Workers)

[![CI](https://github.com/dongho-jung/paw/actions/workflows/ci.yml/badge.svg)](https://github.com/dongho-jung/paw/actions/workflows/ci.yml)
[![Release](https://github.com/dongho-jung/paw/actions/workflows/release.yml/badge.svg)](https://github.com/dongho-jung/paw/actions/workflows/release.yml)

A lightweight orchestration layer for running multiple Claude Code agents in parallel.

## Why PAW?

### Works Anywhere

Run PAW on a remote server via SSH or mosh. Disconnect anytime‚Äîyour agents keep working. Reconnect from any device and pick up where you left off.

```
laptop (start) ‚Üí wifi dies ‚Üí phone (check status) ‚Üí desktop (continue)
```

No browser to keep open. No Electron app eating RAM. Just a persistent terminal session.

### Zero Overhead

| | Browser-based tools | PAW |
|---|---------------------|-----|
| Runtime | Electron/Chrome | Native binary |
| Memory | 500MB+ | ~10MB |
| Connection lost | Session gone | Session persists |
| Remote server | Port forwarding | SSH |

### Full Automation

Each task gets its own git worktree. When done, PAW commits, pushes, and creates a PR (or merges directly)‚Äîautomatically.

```
‚åÉN (new task) ‚Üí agent works ‚Üí ‚åÉF (finish) ‚Üí committed & merged
```

### Stay in the Loop

- Desktop notifications when agents need input
- Action buttons to respond directly from notifications
- Visual status: ü§ñ working ¬∑ üí¨ waiting ¬∑ ‚úÖ done

### No Lock-in

PAW orchestrates Claude Code‚Äîit doesn't replace it. Your `.claude/` settings, MCP servers, and workflows work unchanged. Stop using PAW anytime; your git history stays clean.

## Installation

```bash
brew install dongho-jung/tap/paw
```

## Overview

- Start a tmux-based workspace from any directory with the `paw` command.
- Creating a task automatically launches the Claude Code agent.
- **Git mode**: Each task gets its own worktree when running in a git repo.
- **Non-Git mode**: Shared workspace in the project directory.

## Usage

### Start paw in a project

```bash
cd /path/to/your/project  # git repo or regular directory
paw  # Creates .paw, starts tmux session, and automatically runs new-task
```

- In a git repo: Git mode (worktree created per task)
- In a regular directory: Non-Git mode (shared workspace by default; optional copy mode for isolation)

The first launch automatically opens the task editor.

### Create a task

To add another task inside the tmux session, press `‚åÉN`:
- The inline task input UI opens in the `‚≠êÔ∏èmain` window.
- Submit with `Alt+Enter` (or `F5`) to launch the agent; `Esc` cancels.
- Use `‚å•Tab` to edit per-task options (model, dependencies, branch name, worktree hook) before submitting.

**Task completion**:
- Press `‚åÉF` to finish. In git mode, PAW commits changes and runs the selected finish action (Merge & Push, Merge, PR, or Drop). In non-git or no-commit cases, choose Done or Drop.
- Optional verification and hooks can run before finish/merge (see config).

<details>
<summary>Automatically reopen incomplete tasks with session resume</summary>

If a task is left unfinished and the window or tmux session closes, the next `paw` run automatically reopens those task windows.

**Session Resume**: When reopening, Claude automatically continues the previous conversation (using `claude --continue`), preserving full history and context.
</details>

<details>
<summary>Automatically clean up merged tasks</summary>

Tasks merged externally (PR merge, direct branch merge, etc.) are cleaned up automatically when `paw` runs.
</details>

### Window states

- ‚≠êÔ∏è New task input window
- ü§ñ Working
- üí¨ Waiting (user input required / needs attention)
- ‚úÖ Done
- Status updates are automatic (wait watcher + Claude Code stop hook classification on exit).

## Configuration

### Configuration file

PAW writes a default `.paw/config` on first run (no setup wizard). Edit it to configure hooks and logging.

Git repos use the global workspace by default; non-git directories use local `.paw/`.
To force a local `.paw` workspace for a git repo, run `paw --local`.

<details>
<summary>Example config (.paw/config)</summary>

```
# PAW Configuration
# Generated by paw

# Log format: text or jsonl
log_format: text

# Log rotation (size in MB, backups)
log_max_size_mb: 10
log_max_backups: 3

# Hooks (optional) (supports multi-line command with ': |')
# pre_worktree_hook: echo "pre worktree"
# pre_task_hook: echo "pre task"
# post_task_hook: echo "post task"
# pre_merge_hook: echo "pre merge"
# post_merge_hook: echo "post merge"
```
</details>

### Configuration options

| Setting | Option | Description |
|---------|--------|-------------|
| `log_format` | `text/jsonl` | Log output format |
| `log_max_size_mb` | (MB) | Log rotation size (default: 10) |
| `log_max_backups` | (count) | Log rotation backups (default: 3) |
| `pre_worktree_hook` | (command) | Runs after worktree/workspace creation (e.g., `npm install`) |
| `pre_task_hook` | (command) | Runs before starting the agent |
| `post_task_hook` | (command) | Runs after finishing a task |
| `pre_merge_hook` | (command) | Runs before merge actions (Merge / Merge & Push) |
| `post_merge_hook` | (command) | Runs after successful merge actions |

<details>
<summary>Other configuration</summary>

- System prompt: Embedded in binary (copied to `.paw/.claude/` on first run)
- `.paw/PROMPT.md`: Project-specific prompt (per project)
</details>

## Dependencies

Use `paw check` to verify prerequisites.

| Dependency | Required | Purpose |
|------------|----------|---------|
| tmux | Yes | Terminal multiplexer for managing task windows |
| claude | Yes | Claude Code CLI for running agents |
| git | Optional | Needed for worktree mode in git repositories |
| gh | Optional | PR creation for the PR finish action |

Install tmux/gh via Homebrew: `brew install tmux gh`. Install the Claude Code CLI from https://claude.ai/claude-code.

## Keyboard Shortcuts

### Navigation
| Action | Shortcut |
|--------|----------|
| Cycle panes / task options (new task) | `‚å•Tab` |
| Move window | `‚å•‚Üê/‚Üí` |
| Switch project (jump to other PAW sessions) | `‚åÉJ` |

### Task Commands
| Action | Shortcut |
|--------|----------|
| New task | `‚åÉN` |
| Search task history (new task window) | `‚åÉR` |
| Template picker (new task window) | `‚åÉT` |
| Finish task (shows action picker) | `‚åÉF` |
| Command palette | `‚åÉP` |
| Quit paw | `‚åÉQ` |

### Toggle Panels
| Action | Shortcut |
|--------|----------|
| Toggle logs | `‚åÉO` |
| Toggle git viewer | `‚åÉG` |
| Toggle bottom (shell) | `‚åÉB` |
| Toggle help | `‚åÉ/` |
| Edit prompts | `‚åÉY` |

## Git viewer

Press `‚åÉG` to open the interactive git viewer. Press `‚åÉG` again to close it.

The viewer starts in status mode and allows you to switch between different git views.

<details>
<summary>Controls</summary>

| Key | Description |
|----|-------------|
| `s` | Switch to status mode (`git status`) |
| `L` | Switch to log mode (`git log`) |
| `a` | Switch to all mode (`git log --all --decorate --oneline --graph`) |
| `d` | Switch to diff mode (`git diff main...HEAD`) |
| `Tab` | Cycle modes (STATUS ‚Üí LOG ‚Üí LOG --all ‚Üí DIFF) |
| `1` / `2` / `3` / `4` | Jump to specific mode |
| `/` | Start search |
| `n` / `N` | Next/previous match |
| `w` | Toggle word wrap |
| `‚Üë` / `‚Üì` / `j` / `k` | Scroll vertically |
| `‚Üê` / `‚Üí` / `h` / `l` | Scroll horizontally (when word wrap is off) |
| `g` or `gg` | Jump to top |
| `G` | Jump to bottom |
| `PgUp` / `PgDn` | Page scroll |
| `Ctrl+U` / `Ctrl+D` | Half-page scroll |
| `q` / `Esc` / `‚åÉG` | Close the git viewer |
</details>

## Log viewer

Press `‚åÉO` to open the live log viewer.

Logs are written to `.paw/log` with optional JSONL formatting and rotation.
Use `paw logs --since 2h --task my-task` for CLI filtering.

<details>
<summary>Controls</summary>

| Key | Description |
|----|-------------|
| `‚Üë` / `‚Üì` | Scroll vertically |
| `‚Üê` / `‚Üí` | Scroll horizontally (when word wrap is off) |
| `g` | Jump to top |
| `G` | Jump to bottom |
| `PgUp` / `PgDn` | Page scroll |
| `/` | Start search |
| `n` / `N` | Next/previous match |
| `s` | Toggle tail mode (follow new logs) |
| `w` | Toggle word wrap |
| `Tab` | Cycle log level filter (L0+ ‚Üí L1+ ‚Üí ... ‚Üí L5 only) |
| `‚åÉO` / `q` / `Esc` | Close the log viewer |
</details>

## Task history

When a task ends, the full content of the agent pane is automatically captured and saved.

### Storage location

```
.paw/history/
‚îî‚îÄ‚îÄ YYMMDD_HHMMSS_task-name  # e.g., 241228_134501_my-feature
```

### Usage examples

- Review what the agent did in a past task.
- Trace how a problem was solved.
- Use as reference material for learning and improvement.

Use `paw history` to list entries and `paw history show <index|task|file>` to view one.

## CLI utilities

- `paw attach` - Attach to a running PAW session from anywhere.
  ```bash
  paw attach           # List and select from running sessions
  paw attach myproject # Attach directly to 'myproject' session
  ```
- `paw check --fix` - Attempts Homebrew installs for missing dependencies and repairs missing PAW files/folders.

## Roadmap

- [ ] **Adopt [bubblezone](https://github.com/lrstanley/bubblezone)** - Simplified mouse click zone detection for TUI components. Currently blocked waiting for bubblezone to support [Bubble Tea v2](https://github.com/charmbracelet/bubbletea/discussions/1156). Once supported, this will replace manual coordinate calculations in the Options panel and other clickable UI elements.

## License

MIT. See `LICENSE`.
